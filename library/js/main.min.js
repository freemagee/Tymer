function init(){function n(e,t,n){var r=e.val(),i;if(t==="plus"){i=r*1+1;if(n==="min")if(r<=59){e.val(l(i));$(".number.mins").text(l(i))}else if(r==60){$(".number.mins").text("00");e.val("00")}if(n==="sec")if($(".js-minutes").val()!=60){if(r<=58){e.val(l(i));$(".number.secs").text(l(i))}else if(r==59){$(".number.secs").text("00");e.val("00")}}else u(1)}else if(t==="minus"){i=r-1;if(n==="min")if(r<=60&&r!=0){e.val(l(i));$(".number.mins").text(l(i))}else if(r==0){e.val("60");$(".number.mins").text("60")}if(n==="sec")if($(".js-minutes").val()!=60){if(r<=60&&r!=0){e.val(l(i));$(".number.secs").text(l(i))}else if(r==0){e.val("59");$(".number.secs").text("59")}}else u(1)}}function r(e){var n=$(".tymer").find(".mins"),r=$(".tymer").find(".secs");countdown=setInterval(function(){if(e===0)i();else{e-=1e3;var s=new Date(e),o=s.getSeconds(),u=s.getMinutes(),a=s.getHours();t=e;if(a>=1){r.text(l(o));n.text("60")}else{r.text(l(o));n.text(l(u))}}},1e3)}function i(){clearInterval(countdown);s()}function s(){$(".message-text").text("Tymer Completed");$(".message").addClass("complete").addClass("show");$(".js-prompt-btn").removeClass("help").addClass("dismiss").text("Dismiss");h();var e=setInterval(function(){o();clearInterval(e)},1e3)}function o(){clearInterval(countdown);$(".tymer").removeClass("hasCountdown").removeClass("paused").attr("data-state","waiting");$(".number.mins").text("00");$(".number.secs").text("00");$(".js-minutes").val("00");$(".js-seconds").val("00");$(".tymer-set").removeClass("inactive");$(".tymer-clear").removeClass("active")}function u(t){var n="There has been a technical error with Tymer. Sorry for the inconvenience.";t===0?n="Please enter a time. Use the +/- buttons to adjust minutes and seconds.":t===1&&(n="Maximum Tymer is 60 minutes");$(".message-text").text(n);$(".message").addClass("error").addClass("show");$(".js-prompt-btn").removeClass("help").addClass("dismiss").text("Dismiss");clearInterval(e)}function a(){var e='<button class="help prompt-btn js-prompt-btn">Help</button>';$(e).prependTo("body");$(".js-prompt-btn").on("click",function(e){if($(this).hasClass("help")){var t='<img src="library/img/logo-icon.png" alt="Tymer logo" class="logo-icon"><h2 class="alpha">Simple Free Online Timer</h2><p>Tymer is a mobile optimised countdown timer.<br /> Whether you are cooking, exercising or practising the pomodoro technique, Tymer is for you.</p><ul><li>Supports a countdown up to one hour - [MM:SS]</li><li>Click anywhere to start countdown</li><li>Alarm sounds when Tymer has completed (PC/MAC only)</li></ul><p>More info about <a href="why.html">Tymer</a>. Built by <a href="http://neilmagee.com">Neil Magee</a>.</p>';$(".message-text").html(t);$(".message").addClass("help-panel").addClass("show");$(this).removeClass("help").addClass("dismiss").text("Dismiss")}else if($(this).hasClass("dismiss")){$(".message").attr("class","message");$(".message").find(".message-text").empty();p();$(this).removeClass("dismiss").addClass("help").text("Help")}e.preventDefault()});$("html").on("keyup",function(e){if(e.keyCode===27){$(".message").attr("class","message");$(".message").find(".message-text").empty();p();$(".js-prompt-btn").removeClass("dismiss").addClass("help").text("Help")}})}function f(){var e='<div class="message"><span class="message-text"></span></div>';$(e).prependTo("body")}function l(e){var t;e<10?t=("0"+e).slice(-2):t=e;return t}function c(e,t){var n=parseInt(e,10),r=parseInt(t,10);return n<=60&&n>=1?!0:n===0&&r>0?!0:!1}function h(){$('<audio id="alert-sound"></audio>').prependTo("body");$("#alert-sound").attr({autoplay:!0,loop:!0});$('<source src="library/audio/alert.wav" type="audio/wav"><source src="library/audio/alert.mp3" type="audio/mp3">').prependTo("#alert-sound")}function p(){$("#alert-sound").length>0&&$("#alert-sound").remove()}function d(){function l(){var e;a<s?e=Math.floor(u/100*95):a*4+a/100*10>i?e=s*t:e=o;output='<style type="text/css" id="fit">';output+=".tymer { height : "+r+"px } ";output+=".tymer span { line-height : "+r+"px; ";output+="font-size: "+e+"px; }";output+="</style>";return output}var e=16,t=1.71,n=$(".tymer-set").height(),r=window.innerHeight-n,i=window.innerWidth,s=Math.floor(i/100*24),o=parseFloat($(".tymer span").css("font-size")),u=r,a=Math.floor(u/t),f=l();$("#fit").length>0&&$("#fit").remove();$(f).appendTo("head")}var e,t;$(".tymer").addClass("active");$(".tymer-controls").addClass("active");$(".js-minutes").on("change",function(){var t=l($(this).val());clearInterval(e);if(t<=59)$(".number.mins").text(t);else if(t==60){$(".number.mins").text(t);$(".number.secs").text("00")}else{u(1);$(this).val(60);$(".number.mins").text(60)}});$(".js-seconds").on("change",function(){var t=l($(this).val()),n=l($(".js-minutes").val());clearInterval(e);if(t<=59)if(n!=60)$(".number.secs").text(t);else{u(1);$(this).val(0);$(".number.secs").text("00")}else{$(this).val(0);$(".number.secs").text("00")}});$(".tymer").on("click",function(){var e=$(this).hasClass("hasCountdown");if(!e){var n=parseInt($(".js-minutes").val()),i=parseInt($(".js-seconds").val());if(c(n,i)){var s=n*60+i*1,o=s*1e3;$(".tymer-set").addClass("inactive");$(".tymer-clear").addClass("active");$(this).addClass("hasCountdown");r(o)}else u(0)}else{var a=$(this).attr("data-state");if(a=="waiting"){$(this).addClass("paused");$(this).attr("data-state","paused");clearInterval(countdown)}else{$(this).removeClass("paused");$(this).attr("data-state","waiting");r(t)}}return!1});$(".js-clear").on("click",function(){o();return!1});$(".js-mins-minus").on("mousedown",function(){var t=$(".js-minutes");n(t,"minus","min");e=setInterval(function(){n(t,"minus","min")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-mins-plus").on("mousedown",function(){var t=$(".js-minutes");n(t,"plus","min");e=setInterval(function(){n(t,"plus","min")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-secs-minus").on("mousedown",function(){var t=$(".js-seconds");n(t,"minus","sec");e=setInterval(function(){n(t,"minus","sec")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-secs-plus").on("mousedown",function(){var t=$(".js-seconds");n(t,"plus","sec");e=setInterval(function(){n(t,"plus","sec")},300)}).on("mouseup",function(){clearInterval(e)});f();a();d();$(window).on("resize",function(){d()})}$(document).ready(function(){init()});