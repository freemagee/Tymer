$(document).ready(function(){function e(e,s,t){var a,r=e.val();"plus"===s?(a=1*r+1,"min"===t?59>=r?(e.val(o(a)),60>=a&&$(".number.mins").text(o(a))):n(1):"sec"===t&&58>=r&&(e.val(o(a)),59>=a&&$(".number.secs").text(o(a)))):"minus"===s&&(a=r-1,r>=1&&(e.val(o(a)),a>=0&&$(".number."+t+"s").text(o(a))))}function s(){$(".message-text").text("Tymer Completed"),$(".message").addClass("complete").addClass("show"),a($(".message")),u(),t()}function t(){$(".tymer").removeClass("hasCountdown").removeClass("paused").countdown("pause"),$(".number.mins").text("00"),$(".number.secs").text("00"),$(".js-minutes").val("00"),$(".js-seconds").val("00"),$(".tymer-set").addClass("active"),$(".tymer-clear").removeClass("active"),$(".js-pause").text("Pause").data("state",!1)}function n(e){var s="There has been a technical error with Tymer. Sorry for the inconvenience.";0===e?s="Please enter a time. Format [MM:SS].":1===e&&(s="Maximum Tymer is 60 minutes"),$(".message-text").text(s),$(".message").addClass("error").addClass("show"),a($(".message")),clearInterval(m)}function a(e){e.click(function(e){$(this).removeClass("show").removeClass("error").removeClass("complete"),$(this).find(".message-text").empty(),i(),e.preventDefault()}),$("html").on("keyup",function(s){27===s.keyCode&&(e.removeClass("show").removeClass("error").removeClass("complete"),i())})}function o(e){var s;return s=10>e?("0"+e).slice(-2):e}function r(e,s){var t=parseInt(e,10),n=parseInt(s,10);return 60>=t&&t>=1?!0:0===t&&n>0?!0:!1}function u(){$('<audio id="alert-sound"></audio>').prependTo("body"),$("#alert-sound").attr({autoplay:!0,loop:!0}),$('<source src="library/audio/alert.wav" type="audio/wav"><source src="library/audio/alert.mp3" type="audio/mp3">').prependTo("#alert-sound")}function i(){$("#alert-sound").length>0&&$("#alert-sound").remove()}function l(){function e(){var e;return e=o>i?Math.floor(95*(u/100)):4*i+10*(i/100)>a?o*s:r,output='<style type="text/css" id="fit">',output+=".tymer { height : "+n+"px } ",output+=".tymer span { line-height : "+n+"px; ",output+="font-size: "+e+"px; }",output+="</style>"}var s=1.71,t=$(".tymer-set").height(),n=window.innerHeight-t,a=window.innerWidth,o=Math.floor(24*(a/100)),r=parseFloat($(".tymer span").css("font-size")),u=n,i=Math.floor(u/s),l=e();$("#fit").length>0&&$("#fit").remove(),$(l).appendTo("head")}var m;$(".tymer").addClass("active"),$(".tymer-set").addClass("active"),$(".js-help").on("click",function(){$(".help-panel").addClass("show"),a($(".help-panel"))}),$(".js-minutes").on("change",function(){var e=o($(this).val());clearInterval(m),59>=e?$(".number.mins").text(e):60==e?($(".number.mins").text(e),$(".number.secs").text("00")):(n(1),$(this).val(60),$(".number.mins").text(60))}),$(".js-seconds").on("change",function(){var e=o($(this).val()),s=o($(".js-minutes").val());clearInterval(m),59>=e?60!=s?$(".number.secs").text(e):(n(1),$(this).val(0),$(".number.secs").text("00")):($(this).val(0),$(".number.secs").text("00"))}),$(".tymer").on("click",function(){var e=$(this).hasClass("hasCountdown");if(e){var t=$(this).data("state");t=!t,t?$(this).countdown("pause").addClass("paused"):$(this).countdown("resume").removeClass("paused"),$(this).data("state",t)}else{var a=$(".js-minutes").val(),o=$(".js-seconds").val();if(r(a,o)){var u=60*a+1*o;$(".tymer-set").removeClass("active"),$(".tymer-clear").addClass("active"),$(".tymer").countdown({until:u,format:"MS",compact:!0,layout:'<span class="number mins">{mnn}</span><span class="sep"></span><span class="number secs">{snn}</span>',onExpiry:s})}else n(0)}return!1}),$(".js-clear").on("click",function(){return t(),!1}),$(".js-mins-minus").on("mousedown",function(){var s=$(".js-minutes");e(s,"minus","min"),m=setInterval(function(){e(s,"minus","min")},300)}).on("mouseup",function(){clearInterval(m)}),$(".js-mins-plus").on("mousedown",function(){var s=$(".js-minutes");e(s,"plus","min"),m=setInterval(function(){e(s,"plus","min")},300)}).on("mouseup",function(){clearInterval(m)}),$(".js-secs-minus").on("mousedown",function(){var s=$(".js-seconds");e(s,"minus","sec"),m=setInterval(function(){e(s,"minus","sec")},300)}).on("mouseup",function(){clearInterval(m)}),$(".js-secs-plus").on("mousedown",function(){var s=$(".js-seconds");e(s,"plus","sec"),m=setInterval(function(){e(s,"plus","sec")},300)}).on("mouseup",function(){clearInterval(m)}),l(),$(window).on("resize",function(){l()})});