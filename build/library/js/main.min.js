function init(){function r(e,t,n){var r=e.val(),i;if(t==="plus"){i=r*1+1;if(n==="min")if(r<=59){e.val(c(i));$(".number.mins").text(c(i))}else if(r===60){$(".number.mins").text("00");e.val("00")}if(n==="sec")if($(".js-minutes").val()!==60){if(r<=58){e.val(c(i));$(".number.secs").text(c(i))}else if(r===59){$(".number.secs").text("00");e.val("00")}}else a(1)}else if(t==="minus"){i=r-1;if(n==="min")if(r<=60&&r!==0){e.val(c(i));$(".number.mins").text(c(i))}else if(r===0){e.val("60");$(".number.mins").text("60")}if(n==="sec")if($(".js-minutes").val()!==60){if(r<=60&&r!==0){e.val(c(i));$(".number.secs").text(c(i))}else if(r===0){e.val("59");$(".number.secs").text("59")}}else a(1)}}function i(e){var r=$(".tymer").find(".mins"),i=$(".tymer").find(".secs");n=setInterval(function(){if(e===0)s();else{e-=1e3;var n=new Date(e),o=n.getSeconds(),u=n.getMinutes(),a=n.getHours();t=e;if(a>=1){i.text(c(o));r.text("60")}else{i.text(c(o));r.text(c(u))}}},1e3)}function s(){clearInterval(n);o()}function o(){$(".message-text").text("Tymer Completed");$(".message").addClass("complete").addClass("show");$(".js-prompt-btn").removeClass("help").addClass("dismiss").text("x");p();var e=setInterval(function(){u();clearInterval(e)},1e3)}function u(){clearInterval(n);$(".tymer").removeClass("hasCountdown").removeClass("paused").attr("data-state","waiting");$(".number.mins").text("00");$(".number.secs").text("00");$(".js-minutes").val("00");$(".js-seconds").val("00");$(".tymer-set").removeClass("inactive");$(".tymer-clear").removeClass("active")}function a(t){var n="There has been a technical error with Tymer. Sorry for the inconvenience.";t===0?n="Please enter a time. Use the +/- buttons to adjust minutes and seconds.":t===1?n="Maximum Tymer is 60 minutes":t===2&&(n="The value you entered is not valid. Please check and try again.");$(".message-text").text(n);$(".message").addClass("error").addClass("show");$(".js-prompt-btn").removeClass("help").addClass("dismiss").text("x");clearInterval(e)}function f(){var e='<button class="help prompt-btn js-prompt-btn">?</button>';$(e).prependTo("body");$(".js-prompt-btn").on("click",function(e){if($(this).hasClass("help")){var t='<img src="library/img/logo-icon.png" alt="Tymer logo" class="logo-icon"><h2 class="alpha">Simple Free Online Timer</h2><p>Tymer is a mobile optimised countdown timer.<br /> Whether you are cooking, exercising or practising the pomodoro technique, Tymer is for you.</p><ul><li>Supports a countdown up to one hour - [MM:SS]</li><li>Click anywhere to start countdown</li><li>Alarm sounds when Tymer has completed (PC/MAC only)</li></ul><p>More info about <a href="why.html">Tymer</a>. Built by <a href="http://neilmagee.com">Neil Magee</a>.</p>';$(".message-text").html(t);$(".message").addClass("help-panel").addClass("show");$(this).removeClass("help").addClass("dismiss").text("x")}else if($(this).hasClass("dismiss")){$(".message").attr("class","message");$(".message").find(".message-text").empty();d();$(this).removeClass("dismiss").addClass("help").text("?")}e.preventDefault()});$("html").on("keyup",function(e){if(e.keyCode===27){$(".message").attr("class","message");$(".message").find(".message-text").empty();d();$(".js-prompt-btn").removeClass("dismiss").addClass("help").text("?")}})}function l(){var e='<div class="message"><span class="message-text"></span></div>';$(e).prependTo("body")}function c(e){var t;e<10?t=("0"+e).slice(-2):t=e;return t}function h(e,t){var n=parseInt(e,10),r=parseInt(t,10);return n<=60&&n>=1?!0:n===0&&r>0?!0:!1}function p(){$('<audio id="alert-sound"></audio>').prependTo("body");$("#alert-sound").attr({autoplay:!0,loop:!0});$('<source src="library/audio/alert.wav" type="audio/wav"><source src="library/audio/alert.mp3" type="audio/mp3">').prependTo("#alert-sound")}function d(){$("#alert-sound").length>0&&$("#alert-sound").remove()}function v(){function f(){var t,a;u<i?a=Math.floor(o/100*95):u*4+u/100*10>r?a=i*e:a=s;t='<style type="text/css" id="fit">';t+=".tymer { height : "+n+"px } ";t+=".tymer span { line-height : "+n+"px; ";t+="font-size: "+a+"px; }";t+="</style>";return t}var e=1.71,t=$(".tymer-set").height(),n=window.innerHeight-t,r=window.innerWidth,i=Math.floor(r/100*24),s=parseFloat($(".tymer span").css("font-size")),o=n,u=Math.floor(o/e),a;$("#fit").length>0&&$("#fit").remove();a=f();$(a).appendTo("head")}var e,t,n;$(".tymer").addClass("active");$(".tymer-controls").addClass("active");$(".js-minutes").on("change",function(){var t=$(this).val().substr(-2,2),n;if($.isNumeric(t)&&t>=0){n=c(t);clearInterval(e);if(n<=59)$(".number.mins").text(n);else if(n===60){$(".number.mins").text(n);$(".number.secs").text("00")}else{a(1);$(this).val(60);$(".number.mins").text(60)}}else{a(2);$(this).val("00")}});$(".js-seconds").on("change",function(){var t=$(this).val().substr(-2,2);clearInterval(e);if($.isNumeric(t)&&t>=0){var n=c($(".js-minutes").val()),r=c(t);if(r<=59)if(n!==60)$(".number.secs").text(r);else{a(1);$(this).val("00");$(".number.secs").text("00")}else{$(this).val("00");$(".number.secs").text("00")}}else{a(2);$(this).val("00")}});$(".tymer").on("click",function(){var e=$(this).hasClass("hasCountdown");if(!e){var r=parseInt($(".js-minutes").val()),s=parseInt($(".js-seconds").val());if(h(r,s)){var o=r*60+s*1,u=o*1e3;$(".tymer-set").addClass("inactive");$(".tymer-clear").addClass("active");$(this).addClass("hasCountdown");i(u)}else a(0)}else{var f=$(this).attr("data-state");if(f==="waiting"){$(this).addClass("paused");$(this).attr("data-state","paused");clearInterval(n)}else{$(this).removeClass("paused");$(this).attr("data-state","waiting");i(t)}}return!1});$(".js-clear").on("click",function(){u();return!1});$(".js-mins-minus").on("mousedown",function(){var t=$(".js-minutes");r(t,"minus","min");e=setInterval(function(){r(t,"minus","min")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-mins-plus").on("mousedown",function(){var t=$(".js-minutes");r(t,"plus","min");e=setInterval(function(){r(t,"plus","min")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-secs-minus").on("mousedown",function(){var t=$(".js-seconds");r(t,"minus","sec");e=setInterval(function(){r(t,"minus","sec")},300)}).on("mouseup",function(){clearInterval(e)});$(".js-secs-plus").on("mousedown",function(){var t=$(".js-seconds");r(t,"plus","sec");e=setInterval(function(){r(t,"plus","sec")},300)}).on("mouseup",function(){clearInterval(e)});l();f();v();$(window).on("resize",function(){v()})}$(document).ready(function(){init()});